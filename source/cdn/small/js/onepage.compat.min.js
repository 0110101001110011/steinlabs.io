"use strict";var _createClass=function(){function e(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(n,t,i){return t&&e(n.prototype,t),i&&e(n,i),n}}();function _classCallCheck(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}var Typewriter=function(){function e(){_classCallCheck(this,e),this.currentElement=null,this.typing=!1,this.index=0,this.loopSleep=0,this.innerHTML=null,this.currentID=0,this.forceFinish=!1}return _createClass(e,[{key:"recursiveType",value:function(e,n){var t=this;if(this.currentID==e&&this.typing&&!(this.index>this.endIndex))return this.forceFinish?(this.currentElement.innerHTML=this.innerHTML,this.forceFinish=!1,void(this.typing=!1)):void setTimeout(function(){if("<"==t.innerHTML.charAt(t.index)){for(var i="";">"!=t.innerHTML.charAt(t.index);)i+=t.innerHTML.charAt(t.index),t.index++;t.currentElement.innerHTML+=i+">",t.index++,n="</"+i.charAt(1)+">"}else n?t.currentElement.innerHTML=t.currentElement.innerHTML.replace(n,"")+t.innerHTML.charAt(t.index):t.currentElement.innerHTML+=t.innerHTML.charAt(t.index),t.index++;t.recursiveType(e,n)},this.loopSleep);this.typing=!1}},{key:"resetPreviousElement",value:function(){this.currentElement&&(this.currentElement.innerHTML=this.innerHTML)}},{key:"type",value:function(e,n){this.stop(),this.currentID++;var t=this.currentID;this.typing=!0,this.currentElement=e,this.index=0,this.loopSleep=Math.floor(1e3/n),this.innerHTML=e.innerHTML.trim(),this.endIndex=this.innerHTML.length,this.currentElement.textContent="",this.recursiveType(t,null)}},{key:"stop",value:function(){this.typing=!1,this.resetPreviousElement()}},{key:"isTyping",value:function(){return this.typing}},{key:"finish",value:function(){this.forceFinish=!0}}]),e}(),SCROLL_TARGET=document.getElementById("scroll-target"),PAGES=[].slice.call(document.getElementsByClassName("section-base")).sort(function(e,n){return e.id>n.id}),MAX_INDEX=Math.max(PAGES.length-1,0),CURRENT_INDEX=0,CONTENT_INDICATOR=document.getElementById("content-indicator"),VN_TEXT_BLOCKS=[].slice.call(document.getElementsByClassName("vn-text")).sort(function(e,n){return e.id>n.id}),CURRENT_VN_TEXT_INDEX=0,MAX_VN_TEXT_INDEX=Math.max(VN_TEXT_BLOCKS.length-1,0),VN_ARROW_LEFT=document.getElementById("vn-arrow-left"),VN_ARROW_RIGHT=document.getElementById("vn-arrow-right"),PORTFOLIO_THUMBNAILS=document.getElementsByClassName("portfolio-thumbnail"),PORTFOLIO_PAGES=[].slice.call(document.getElementsByClassName("portfolio-page-wrapper")).reduce(function(e,n){return e[n.id]=n,e},{}),PORTFOLIO_X_BUTTONS=document.getElementsByClassName("portfolio-x-button"),PORTFOLIO_OPEN=!1,TIME_PER_PAGE=400,ZS=zenscroll.createScroller(SCROLL_TARGET,TIME_PER_PAGE,0),TYPEWRITER=new Typewriter,SPLASH_VIDEO=document.getElementById("splash-video"),LAST_SCROLL_DELTA=0;function clamp(e,n,t){return Math.min(Math.max(e,n),t)}function getScrollbarWidth(){return window.innerWidth-SCROLL_TARGET.clientWidth}function vnStep(e,n){e&&e.preventDefault();var t=CURRENT_VN_TEXT_INDEX,i=clamp(CURRENT_VN_TEXT_INDEX+n,0,MAX_VN_TEXT_INDEX);t!=i&&(TYPEWRITER.isTyping()?TYPEWRITER.finish():(CURRENT_VN_TEXT_INDEX=i,VN_TEXT_BLOCKS[t].classList.toggle("hidden"),TYPEWRITER.type(VN_TEXT_BLOCKS[CURRENT_VN_TEXT_INDEX],16),VN_TEXT_BLOCKS[CURRENT_VN_TEXT_INDEX].classList.toggle("hidden"))),0==CURRENT_VN_TEXT_INDEX?(VN_ARROW_LEFT.classList.add("non-active"),VN_ARROW_RIGHT.classList.remove("non-active")):CURRENT_VN_TEXT_INDEX==MAX_VN_TEXT_INDEX?(VN_ARROW_LEFT.classList.remove("non-active"),VN_ARROW_RIGHT.classList.add("non-active")):(VN_ARROW_LEFT.classList.remove("non-active"),VN_ARROW_RIGHT.classList.remove("non-active"))}function scrollToSection(e){difference=e-CURRENT_INDEX,LAST_SCROLL_DELTA=clamp(difference,-1,1),scroll(difference,difference)}function scroll(e,n){if(!ZS.moving()&&!(document.fullscreenElement&&null!==document.fullscreenElement||document.webkitFullscreenElement&&null!==document.webkitFullscreenElement||document.mozFullScreenElement&&null!==document.mozFullScreenElement||document.msFullscreenElement&&null!==document.msFullscreenElement)){LAST_SCROLL_DELTA=clamp(e,-1,1),CURRENT_INDEX=clamp(CURRENT_INDEX+LAST_SCROLL_DELTA*n,0,MAX_INDEX);var t=TIME_PER_PAGE*Math.ceil(Math.abs(n)/2);0==CURRENT_INDEX&&SPLASH_VIDEO.play(),ZS.to(PAGES[CURRENT_INDEX],t,function(){0!=CURRENT_INDEX&&SPLASH_VIDEO.pause(),window.location.hash="s"+CURRENT_INDEX})}}function scrollWrap(e,n){scroll(e,n)}function togglePortfolioPage(e,n){n?(PORTFOLIO_PAGES[e].classList.add("portfolio-page-visible"),PORTFOLIO_PAGES[e].style.pointerEvents="",PORTFOLIO_OPEN=e,toggleGalleries(!0,0,e)):(PORTFOLIO_PAGES[e].classList.remove("portfolio-page-visible"),PORTFOLIO_PAGES[e].style.pointerEvents="none",[].slice.call(VIDEO_PLAYERS).forEach(function(e){e.pause()}),PORTFOLIO_OPEN=null,toggleGalleries(!1,500))}function updateIndexByHash(){window.location.hash&&window.location.hash.match("^#s[0-9]$")&&(CURRENT_INDEX=parseInt(window.location.hash.replace("#s",""))),0==CURRENT_INDEX&&SPLASH_VIDEO.play(),ZS.to(PAGES[CURRENT_INDEX],0),0!=CURRENT_INDEX?SPLASH_VIDEO.pause():SPLASH_VIDEO.play()}function init(){updateIndexByHash(),SCROLL_TARGET.addEventListener("wheel",function(e){scroll(e.deltaY,1),e.preventDefault()}),SCROLL_TARGET.addEventListener("touchstart",function(e){LAST_Y_POS=e.targetTouches[0].clientY}),SCROLL_TARGET.addEventListener("touchmove",function(e){scroll(LAST_Y_POS-e.targetTouches[0].clientY,1),e.preventDefault(),LAST_Y_POS=e.targetTouches[0].clientY}),window.addEventListener("keydown",function(e){var n=e.keyCode;[34,35,40].includes(n)||32==n&&!e.shiftKey?(scroll(1,35==n?MAX_INDEX:1),e.preventDefault()):([33,36,38].includes(n)||32==n&&e.shiftKey)&&(scroll(-1,36==n?MAX_INDEX:1),e.preventDefault()),1==CURRENT_INDEX&&([8,37].includes(n)?vnStep(null,-1):[13,39].includes(n)&&vnStep(null,1)),2==CURRENT_INDEX&&([8,37].includes(n)?traverseActiveGallery(e,!0):[13,39].includes(n)&&traverseActiveGallery(e,!1),27==n&&PORTFOLIO_OPEN&&togglePortfolioPage(PORTFOLIO_OPEN,!1))}),SCROLL_TARGET.addEventListener("mousedown",function(e){2==e.button&&(LAST_Y_POS=e.clientY,e.preventDefault())}),SCROLL_TARGET.addEventListener("mousemove",function(e){1==e.button&&(scroll(e.clientY-LAST_Y_POS,1),e.preventDefault(),LAST_Y_POS=e.clientY)}),VN_ARROW_LEFT.addEventListener("click",function(e){vnStep(e,-1)}),VN_ARROW_RIGHT.addEventListener("click",function(e){vnStep(e,1)}),VN_ARROW_LEFT.addEventListener("touchmove",function(e){e.stopPropagation(),e.preventDefault()}),VN_ARROW_RIGHT.addEventListener("touchmove",function(e){e.stopPropagation(),e.preventDefault()}),window.addEventListener("resize",function(e){ZS.stop(),ZS.to(PAGES[CURRENT_INDEX],0)});for(var e=function(e){PORTFOLIO_THUMBNAILS[e].addEventListener("click",function(n){togglePortfolioPage(PORTFOLIO_THUMBNAILS[e].id.replace("tn-",""),!0)})},n=0;n<PORTFOLIO_THUMBNAILS.length;n++)e(n);var t=function(e){PORTFOLIO_X_BUTTONS[e].addEventListener("click",function(n){togglePortfolioPage(PORTFOLIO_THUMBNAILS[e].id.replace("tn-",""),!1)})};for(n=0;n<PORTFOLIO_X_BUTTONS.length;n++)t(n);window.addEventListener("hashchange",function(e){updateIndexByHash()})}init();